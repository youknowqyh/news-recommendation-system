(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{28:function(e,s,t){},31:function(e,s,t){},32:function(e,s,t){},34:function(e,s,t){},40:function(e,s,t){},41:function(e,s,t){},42:function(e,s,t){"use strict";t.r(s);var a=t(1),n=t.n(a),r=t(21),c=t.n(r),i=(t(28),t(6)),o=t(7),l=t(11),d=t(10),h=(t(29),t(30),t(2)),j=(t(31),t(12)),u=(t(32),t(22)),m=t.n(u),p=function(){function e(){Object(i.a)(this,e)}return Object(o.a)(e,null,[{key:"authenticateUser",value:function(e,s){localStorage.setItem("token",e),localStorage.setItem("email",s)}},{key:"isUserAuthenticated",value:function(){return null!==localStorage.getItem("token")}},{key:"deauthenticateUser",value:function(){localStorage.removeItem("token"),localStorage.removeItem("email")}},{key:"getToken",value:function(){return localStorage.getItem("token")}},{key:"getEmail",value:function(){return localStorage.getItem("email")}}]),e}(),b=(t(34),t(0)),O=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(){return Object(i.a)(this,t),s.apply(this,arguments)}return Object(o.a)(t,[{key:"redirectToUrl",value:function(e){this.sendClickLog(),window.open(e,"_blank")}},{key:"sendClickLog",value:function(){var e="http://localhost:3000/news/userId/"+p.getEmail()+"/newsId/"+this.props.news.digest,s=new Request(encodeURI(e),{method:"POST",headers:{Authorization:"bearer "+p.getToken()},cache:"no-cache"});fetch(s)}},{key:"render",value:function(){var e=this;return Object(b.jsx)("div",{className:"news-container",onClick:function(){return e.redirectToUrl(e.props.news.url)},children:Object(b.jsxs)("div",{className:"row",children:[Object(b.jsx)("div",{className:"col s4 fill",children:Object(b.jsx)("img",{src:this.props.news.urlToImage,alt:"news"})}),Object(b.jsx)("div",{className:"col s8",children:Object(b.jsx)("div",{className:"news-intro-col",children:Object(b.jsxs)("div",{className:"news-intro-panel",children:[Object(b.jsx)("h4",{children:this.props.news.title}),Object(b.jsxs)("div",{className:"news-description",children:[Object(b.jsx)("p",{children:this.props.news.description}),Object(b.jsxs)("div",{children:[null!=this.props.news.source.id&&Object(b.jsx)("div",{className:"chip light-blue news-chip",children:this.props.news.source.name}),null!=this.props.news.reason&&Object(b.jsx)("div",{className:"chip light-green news-chip",children:this.props.news.reason}),null!=this.props.news.time&&Object(b.jsx)("div",{className:"chip amber news-chip",children:this.props.news.time})]})]})]})})})]})})}}]),t}(n.a.Component),g=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(){var e;return Object(i.a)(this,t),(e=s.call(this)).state={news:null,pageNum:1,totalPages:1,loadedAll:!1},e.handleScroll=e.handleScroll.bind(Object(j.a)(e)),e}return Object(o.a)(t,[{key:"componentDidMount",value:function(){p.isUserAuthenticated()&&this.loadMoreNews(),this.loadMoreNews=m.a.debounce(this.loadMoreNews,1e3),window.addEventListener("scroll",this.handleScroll)}},{key:"handleScroll",value:function(){var e=window.scrollY||window.pageYOffset||document.documentElement.scrollTop;window.innerHeight+e>=document.body.offsetHeight-50&&(console.log("Loading more news"),this.loadMoreNews())}},{key:"loadMoreNews",value:function(e){var s=this;if(!0!==this.state.loadedAll){var t="http://localhost:3000/news/userId/"+p.getEmail()+"/pageNum/"+this.state.pageNum,a=new Request(encodeURI(t),{method:"GET",headers:{Authorization:"bearer "+p.getToken()},cache:"no-cache"});fetch(a).then((function(e){return e.json()})).then((function(e){e&&0!==e.length||s.setState({loadedAll:!0}),s.setState({news:s.state.news?s.state.news.concat(e):e,pageNum:s.state.pageNum+1})}))}}},{key:"renderNews",value:function(){var e=this.state.news.map((function(e){return Object(b.jsx)("a",{className:"list-group-item",href:"#",children:Object(b.jsx)(O,{news:e})},e.digest)}));return Object(b.jsx)("div",{className:"container-fluid",children:Object(b.jsx)("div",{className:"list-group",children:e})})}},{key:"render",value:function(){return p.isUserAuthenticated()?this.state.news?Object(b.jsx)("div",{children:this.renderNews()}):Object(b.jsx)("div",{children:Object(b.jsx)("div",{id:"msg-app-loading",children:"Loading"})}):(this.props.history.replace("/login"),Object(b.jsx)("div",{className:"container",children:"Please login first"}))}}]),t}(n.a.Component),v=Object(h.f)(g),w=t(8),x=Object(h.f)((function(e){var s=this,t=e.children;e.history;return Object(b.jsxs)("div",{children:[Object(b.jsx)("nav",{className:"nav-bar  light-blue darken-4",children:Object(b.jsxs)("div",{className:"nav-wrapper",children:[Object(b.jsx)(w.b,{to:"/",className:"brand-logo",children:"\xa0\xa0News Feed"}),Object(b.jsx)("ul",{id:"nav-mobile",className:"right",children:p.isUserAuthenticated()?Object(b.jsxs)("div",{children:[Object(b.jsx)("li",{children:p.getEmail()}),Object(b.jsx)("li",{children:Object(b.jsx)("a",{href:"/",onClick:function(){p.deauthenticateUser((function(){return s.props.history.push("/logout")}))},children:"Log out"})})]}):Object(b.jsxs)("div",{children:[Object(b.jsx)("li",{children:Object(b.jsx)(w.b,{to:"/login",children:"Log in"})}),Object(b.jsx)("li",{children:Object(b.jsx)(w.b,{to:"/signup",children:"Sign up"})})]})})]})}),Object(b.jsx)("br",{}),t]})})),f=(t(40),function(e){var s=e.onSubmit,t=e.onChange,a=e.errors;e.user;return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"card-panel login-panel",children:Object(b.jsxs)("form",{className:"col s12",action:"/",onSubmit:s,children:[Object(b.jsx)("h4",{className:"center-align",children:"Login"}),a.summary&&Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("p",{className:"error-message",children:a.summary})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"input-field col s12",children:[Object(b.jsx)("input",{className:"validate",id:"email",type:"email",name:"email",onChange:t}),Object(b.jsx)("label",{htmlFor:"email",children:"Email"})]})}),a.email&&Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("p",{className:"error-message",children:a.email})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"input-field col s12",children:[Object(b.jsx)("input",{className:"validate",id:"password",type:"password",name:"password",onChange:t}),Object(b.jsx)("label",{htmlFor:"password",children:"Password"})]})}),a.password&&Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("p",{className:"error-message",children:a.password})}),Object(b.jsx)("div",{className:"row right-align",children:Object(b.jsx)("button",{type:"submit",className:"waves-effect waves-light btn light-blue darken-4",value:"Log in",children:"Log in"})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("p",{className:"right-align",children:[" New to here? ",Object(b.jsx)(w.b,{to:"/signup",children:"Sign up"})]})})]})})})}),N=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(e,a){var n;return Object(i.a)(this,t),(n=s.call(this,e,a)).state={errors:{},user:{email:"",password:""}},n.processForm=n.processForm.bind(Object(j.a)(n)),n.changeUser=n.changeUser.bind(Object(j.a)(n)),n}return Object(o.a)(t,[{key:"processForm",value:function(e){var s=this;e.preventDefault();var t=this.state.user.email,a=this.state.user.password;console.log("email:",t),console.log("password:",a),fetch("http://localhost:3000/auth/login",{method:"POST",cache:"no-cache",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.user.email,password:this.state.user.password})}).then((function(e){200===e.status?(s.setState({error:{}}),e.json().then((function(e){console.log(e),p.authenticateUser(e.token,t),s.props.history.replace("/")}))):(console.log("login failed"),e.json().then((function(e){var t=e.errors?e.errors:{};t.summary=e.message,s.setState({errors:t})})))}))}},{key:"changeUser",value:function(e){var s=e.target.name,t=this.state.user;t[s]=e.target.value,this.setState({user:t})}},{key:"render",value:function(){return Object(b.jsx)(f,{onSubmit:this.processForm,onChange:this.changeUser,errors:this.state.errors,user:this.state.user})}}]),t}(a.Component),y=(t(41),function(e){var s=e.onSubmit,t=e.onChange,a=e.errors;e.user;return Object(b.jsx)("div",{className:"container",children:Object(b.jsx)("div",{className:"card-panel signup-panel",children:Object(b.jsxs)("form",{className:"col s12",action:"/",onSubmit:s,children:[Object(b.jsx)("h4",{className:"center-align",children:"Sign Up"}),a.summary&&Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("p",{className:"error-message",children:a.summary})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"input-field col s12",children:[Object(b.jsx)("input",{id:"email",type:"email",name:"email",className:"validate",onChange:t}),Object(b.jsx)("label",{htmlFor:"email",children:"Email"})]})}),a.email&&Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("p",{className:"error-message",children:a.email})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"input-field col s12",children:[Object(b.jsx)("input",{id:"password",type:"password",name:"password",className:"validate",onChange:t}),Object(b.jsx)("label",{htmlFor:"password",children:"Password"})]})}),a.password&&Object(b.jsx)("div",{className:"row",children:Object(b.jsx)("p",{className:"error-message",children:a.password})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("div",{className:"input-field col s12",children:[Object(b.jsx)("input",{id:"confirm_password",type:"password",name:"confirm_password",className:"validate",onChange:t}),Object(b.jsx)("label",{htmlFor:"confirm_password",children:"Confirm Password"})]})}),Object(b.jsx)("div",{className:"row right-align",children:Object(b.jsx)("button",{type:"submit",className:"waves-effect waves-light btn light-blue darken-4",value:"Sign Up",children:"Sign Up"})}),Object(b.jsx)("div",{className:"row",children:Object(b.jsxs)("p",{className:"right-align",children:[" Already have an account? ",Object(b.jsx)(w.b,{to:"/login",children:"Log in"})]})})]})})})}),k=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(e){var a;return Object(i.a)(this,t),(a=s.call(this,e)).state={errors:{},user:{email:"",password:"",confirm_password:""}},a.processForm=a.processForm.bind(Object(j.a)(a)),a.changeUser=a.changeUser.bind(Object(j.a)(a)),a}return Object(o.a)(t,[{key:"processForm",value:function(e){var s=this;e.preventDefault();var t=this.state.user.email,a=this.state.user.password,n=this.state.user.confirm_password;console.log("email: ",t),console.log("password: ",a),console.log("confirm_password: ",n),a===n&&fetch("http://localhost:3000/auth/signup",{method:"POST",cache:"no-cache",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.user.email,password:this.state.user.password})}).then((function(e){200===e.status?(s.setState({errors:{}}),s.props.history.push("/login")):e.json().then(function(e){console.log(e);var s=e.errors?e.errors:{};s.summary=e.message,console.log(this.state.errors),this.setState({errors:s})}.bind(s))}))}},{key:"changeUser",value:function(e){var s=e.target.name,t=this.state.user;if(t[s]=e.target.value,this.setState({user:t}),console.log(this.state.user.password),this.state.user.password!==this.state.user.confirm_password){var a=this.state.errors;a.password="Password and Confirm Password don't match.",this.setState({errors:a})}else{var n=this.state.errors;n.password="",this.setState({errors:n})}}},{key:"render",value:function(){return Object(b.jsx)(y,{onSubmit:this.processForm,onChange:this.changeUser,errors:this.state.errors,user:this.state.user})}}]),t}(a.Component),S=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(){return Object(i.a)(this,t),s.apply(this,arguments)}return Object(o.a)(t,[{key:"render",value:function(){return Object(b.jsx)("div",{children:Object(b.jsx)(x,{children:Object(b.jsxs)(h.c,{children:[Object(b.jsx)(h.a,{path:"/login",component:N}),Object(b.jsx)(h.a,{path:"/signup",component:k}),Object(b.jsx)(h.a,{path:"/",component:v})]})})})}}]),t}(n.a.Component);c.a.render(Object(b.jsx)(w.a,{children:Object(b.jsx)(S,{})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.f8227921.chunk.js.map